# 1.6 右键菜单（Context Menu）配置说明

## 配置入口
- **T_COST_PAGE_RULE**，ruleType = `CONTEXT_MENU`
- componentKey：`masterGrid`（主表）或具体 tabKey（明细）

## 规则结构
```json
{
  "items": [
    {"action":"addRow","label":"新增"},
    {"action":"copyRow","label":"复制","requiresRow":true},
    {"type":"separator"},
    {"action":"deleteRow","label":"删除","requiresRow":true},
    {"action":"save","label":"保存"}
  ]
}
```

## 支持的内置 action
- addRow / copyRow / deleteRow / save
- saveGridConfig（保存列配置）
- exportSelected / exportCurrent / exportAll / resetExportConfig / openHeaderConfig
- clipboardCopy / clipboardPaste
- separator

> 未识别的 action 会被忽略（对部分可选 action 不会报警）。

## 示例 A：主表右键菜单
```sql
INSERT INTO T_COST_PAGE_RULE (ID, PAGE_CODE, COMPONENT_KEY, RULE_TYPE, RULES, CREATE_BY)
VALUES (
  SEQ_COST_PAGE_RULE.NEXTVAL,
  'cost-demo',
  'masterGrid',
  'CONTEXT_MENU',
  q'~{
    "items": [
      {"action":"addRow","label":"新增"},
      {"action":"copyRow","label":"复制","requiresRow":true},
      {"action":"deleteRow","label":"删除","requiresRow":true},
      {"type":"separator"},
      {"action":"save","label":"保存"},
      {"action":"saveGridConfig","label":"保存列配置"}
    ]
  }~',
  'system'
);
```

## 示例 B：明细 Tab 右键菜单
```sql
INSERT INTO T_COST_PAGE_RULE (ID, PAGE_CODE, COMPONENT_KEY, RULE_TYPE, RULES, CREATE_BY)
VALUES (
  SEQ_COST_PAGE_RULE.NEXTVAL,
  'cost-demo',
  'material',
  'CONTEXT_MENU',
  q'~{
    "items": [
      {"action":"addRow","label":"新增"},
      {"action":"deleteRow","label":"删除","requiresRow":true},
      {"type":"separator"},
      {"action":"clipboardCopy","label":"复制单元格"},
      {"action":"clipboardPaste","label":"粘贴单元格"}
    ]
  }~',
  'system'
);
```

## 多种配置情况
1) **分组菜单**
```json
{
  "items": [
    {"label":"编辑","type":"group","items":[{"action":"addRow"},{"action":"deleteRow"}]},
    {"label":"导出","type":"group","items":[{"action":"exportCurrent"},{"action":"exportAll"}]}
  ]
}
```
2) **动态禁用**：`disabled:true` 或 `requiresSelection:true`

## 注意事项
- 明细菜单按 tabKey 生效；未配置的 tab 使用空菜单。
- 自定义导出菜单会自动追加（当存在自定义导出配置时）。
