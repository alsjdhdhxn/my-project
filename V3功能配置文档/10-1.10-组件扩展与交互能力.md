# 1.10 组件扩展与交互能力（配置说明）

## 配置入口
- **FORM / BUTTON componentConfig**（T_COST_PAGE_COMPONENT.componentConfig）
- **T_COST_PAGE_RULE**：ROW_EDITABLE / ROW_CLASS
- **列 rulesConfig**：脏数据样式 / 行样式 / 单元格样式

## A. 表单渲染器注册（form-renderer-registry）
### 前端注册（代码层）
```ts
import { registerFormRenderer } from '@/v3/composables/meta-v3/form-renderer-registry';
registerFormRenderer('CostForm', CostFormRenderer);
```
### 元数据配置（FORM componentConfig）
```json
{"rendererKey":"CostForm","placeholder":"请配置表单"}
```

## B. 按钮 Action 执行
### componentConfig 示例
```json
{"label":"提交","type":"primary","action":"submit","tableCode":"CostMaster","actionData":{"flag":1}}
```
### 执行策略（优先级）
1) runtime 中存在同名方法（如 save）
2) 通过 `registerActionHandler(actionCode, handler)` 注册的自定义处理
3) 调用后端 `/api/data/{tableCode}/execute`（actionCodes = [action]）

## C. 行级可编辑规则（ROW_EDITABLE）
```sql
INSERT INTO T_COST_PAGE_RULE (ID, PAGE_CODE, COMPONENT_KEY, RULE_TYPE, RULES, CREATE_BY)
VALUES (
  SEQ_COST_PAGE_RULE.NEXTVAL,
  'cost-demo',
  'masterGrid',
  'ROW_EDITABLE',
  '[{"field":"status","operator":"ne","value":"已审核"}]',
  'system'
);
```

## D. 行级样式规则（ROW_CLASS）
```sql
INSERT INTO T_COST_PAGE_RULE (ID, PAGE_CODE, COMPONENT_KEY, RULE_TYPE, RULES, CREATE_BY)
VALUES (
  SEQ_COST_PAGE_RULE.NEXTVAL,
  'cost-demo',
  'masterGrid',
  'ROW_CLASS',
  '[{"field":"status","operator":"eq","value":"异常","className":"row-danger"}]',
  'system'
);
```

## E. 单元格脏数据样式标记
- 内置 class：`cell-user-changed / cell-calc-changed / cell-new / cell-deleted`
- 可在全局样式中覆盖颜色

## 注意事项
- FORM/BUTTON 扩展属于前端注册能力，数据库只负责绑定 rendererKey / action。
- ROW_EDITABLE 与 ROW_CLASS 会叠加到元数据样式（rulesConfig.style）上。
